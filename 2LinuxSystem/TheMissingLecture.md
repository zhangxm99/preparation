# 计算机科学中缺失的课程

简介：这个系列介绍了gnu/linux的相关软件的使用，这里记录一些自己不知道的知识。

## Shell工具与脚本

shell中双引号和单引号是不同的，双引号会将对应的变量进行转义，而单引号只会将字符串忠实地列出来，比如echo "$foo"会去找对应foo的定义，然后进行转换后打印，但echo '$foo'只会简单的打印$foo

shell脚本的编写：
特殊变量：$0 脚本文件名称，$1-9是脚本的对应参数，$@是所有参数，$#是参数个数，$?是前一个命令的返回值，$$是当前脚本的进程识别码,!!是完整的上一条命令，一般用于如果你的权限不够，会再次执行，$_是上一条指令的最后一条参数

返回值如果不是0，全都说明有错误

如果有多个命令要执行，要分清&&和；的区别，前者是与逻辑运算符，由于shell中正确返回值是0，则执行时当出现错误时（即非零值），程序会直接断在相应命令不再执行（出现正值，直接短路），而用；连接则都会执行

重用命令的输出有两种形式，一是常见的$()，这会将括号内的命令运行，并把结果替换掉这个括号，另一种是比较不常用的是<()，这会将括号内命令的输出暂存为文件，然后用文件明代替。

接下来我在这里尝试写一段shell脚本，对输入文件中找到是否存在foobar，如果不存在就加到文件后面：
```
echo "starting program at $data"
for file in $@
	grep foobar $file
	if [[ $? -ne 1 ]];then
		echo "Not Found in $file"
		echo foobar >> $file
	fi
done
```

通配符有两种，一是直接用？表示一个任意的占位，另一个是*，表示任意长的任意字符串

花括号用来表示如果有多个文件有公共子符，则可以直接用花括号自动展开，例如ls pig.{png,jpeg}，会直接展开成ls pig.png pig.jpeg

查找文件

按照文件夹名称进行find

find . -name src -type d

按照文件路径

find . -path /home/ -type f

按照大小查找

find . -size +500k -size -10M -name hello

可以将搜索到的文件上面执行命令

find . -name something -exec rm {} \;

find是通过dfs搜索目录，而locate则是通过updatedb数据库将文件名存起来，因此查找速度会更快，但是要注意uodatedb的数据是每天更新的，所以有可能有些新文件没有被增加进索引中

查找shell命令

在终端中键入CRTL + r就可以输入字串搜索输入历史很方便

xargs 可以方便的将标准输入中的内容变成标准输出，这样就可以处理一些必须需要输入参数而不是标准输入的东西了，例如ls | xargs rm

## 文本处理 
由于awk很好用，这里就重点说awk了。

awk能够很好的处理每行具有相同字段的规则文本（类似csv那种），处理时用-F 指定分割符，默认是空格。

awk有若干的内置变量，比如$0代表当前行，$1 $2等等代表该行的第1 2 个字段，$NF代表该行的字段数量，$NR代表当前是第几行

awk常用的语法有条件规则，也就是前面写condition，后面写动作，例如只输出奇数行的内容：awk -F ':' '$NR % 2 == 1 {print $0}' file.txt

## 版本控制 
